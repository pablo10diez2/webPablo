<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Pablo">
<meta name="description" content="Challenge: If all I have to do is keep my factors p and q secret, then I can save computation time by sharing the same modulus between all my friends. I&amp;rsquo;ll give them unique e and d pairs to encrypt and decrypt messages. Sounds secure to me!
For this we are given 2 files. The first one is a .py and the second one what prints.
from Crypto.Util.number import * from secret import flag # This is my stuff!" />
<meta name="keywords" content=", rsa, Cryptography, math" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://pablo10diez2.github.io/webPablo/posts/dawgctf/baby-rsa2/" />


    <title>
        
            [Cryptography] Baby-RSA 2 :: Welcome!  — Writeups CTF
        
    </title>





  <link rel="stylesheet" href="/webPablo/main.min.ab5336003ba331300318b49292c672210905baf1ef5410a739f647e70c8808fa.css" integrity="sha256-q1M2ADujMTADGLSSksZyIQkFuvHvVBCnOfZH5wyICPo=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="/webPablo/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/webPablo/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/webPablo/favicon-16x16.png">
    <link rel="manifest" href="/webPablo/site.webmanifest">
    <link rel="mask-icon" href="/webPablo/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/webPablo/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="[Cryptography] Baby-RSA 2">
<meta itemprop="description" content="Challenge: If all I have to do is keep my factors p and q secret, then I can save computation time by sharing the same modulus between all my friends. I&rsquo;ll give them unique e and d pairs to encrypt and decrypt messages. Sounds secure to me!
For this we are given 2 files. The first one is a .py and the second one what prints.
from Crypto.Util.number import * from secret import flag # This is my stuff!"><meta itemprop="datePublished" content="2025-04-19T00:00:00+00:00" />
<meta itemprop="dateModified" content="2025-04-19T00:00:00+00:00" />
<meta itemprop="wordCount" content="352">
<meta itemprop="keywords" content="rsa,Cryptography,math," />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="[Cryptography] Baby-RSA 2"/>
<meta name="twitter:description" content="Challenge: If all I have to do is keep my factors p and q secret, then I can save computation time by sharing the same modulus between all my friends. I&rsquo;ll give them unique e and d pairs to encrypt and decrypt messages. Sounds secure to me!
For this we are given 2 files. The first one is a .py and the second one what prints.
from Crypto.Util.number import * from secret import flag # This is my stuff!"/>





    <meta property="article:section" content="Cryptography" />



    <meta property="article:published_time" content="2025-04-19 00:00:00 &#43;0000 UTC" />












    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/webPablo" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                hello</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/webPablo/posts/">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        2 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://pablo10diez2.github.io/webPablo/posts/dawgctf/baby-rsa2/">[Cryptography] Baby-RSA 2</a>
      </h1>

      

      

      

      <div class="post-content">
        <p>Challenge:
<strong>If all I have to do is keep my factors p and q secret, then I can save</strong>
<strong>computation time by sharing the same modulus between all my friends. I&rsquo;ll</strong>
<strong>give them unique e and d pairs to encrypt and decrypt messages. Sounds secure to me!</strong></p>
<p>For this we are given 2 files. The first one is a .py and the second one what prints.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> secret <span style="color:#f92672">import</span> flag
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is my stuff! Don&#39;t look at it</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">512</span>)
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">512</span>)
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> p <span style="color:#f92672">*</span> q
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e_priv <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x10001</span>
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d_priv <span style="color:#f92672">=</span> inverse(e_priv, phi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> bytes_to_long(flag)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> pow(m, e_priv, N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is your stuff!</span>
</span></span><span style="display:flex;"><span>e_pub <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d_pub <span style="color:#f92672">=</span> inverse(e_pub, phi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;e = </span><span style="color:#e6db74">{</span>e_pub<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;d = </span><span style="color:#e6db74">{</span>d_pub<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;N = </span><span style="color:#e6db74">{</span>N<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;c = </span><span style="color:#e6db74">{</span>c<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p><strong>e = 58271</strong>
<strong>d =</strong> <strong>16314065939355844497428646964774413938010062495984944007868244761330321449198604198404787327825341236658059256072790190934480082681534717838850610633320375625893501985237981407305284860652632590435055933317638416556532857376955427517397962124909869006289022084571993305966362498048396739334756594170449299859</strong>
<strong>N =</strong> <strong>11908266771291549727040770227788674365298563844463718805993868100807705889593534576540716051355511201319075171121352338919492532856516466781757032847478539199285763483256</strong>
<strong>2389502866385475392702847788337877472422435555825872297998602400341624700149407637506713864175123267515579305109471947679940924817268027249</strong>
<strong>c =</strong> <strong>1070895821540922853545147589874651120161444554801263669629104142937219656827406742051002228234391509902999896805931793509330204277323867163866850522216802742834694813501</strong>
<strong>06415150660410528574034324184318354089504379956162660478769613136499331243363223860893663583161020156316072996007464894397755058410931262938</strong></p>
<p>For this challenge we are requiered to know RSA cryptography and how their public and private keys work.</p>
<p>A cypher message with RSA is calculated like this, ciphertext = m^e mod n. Where m is
the plain message, e is the public exponent and n is the product of two large numbers p and q.</p>
<p>To return to the plain text we have to decrypt it like this m =c^d mod n, where d is the private key.
d is computed like this d×e ≡ 1 (mod φ(N)). Where φ(N) = (p-1)*(q-1).</p>
<p>As we said e×d ≡ 1 (mod φ(N)) and we can rearrange it like this: e×d − 1 = k × φ(N) for some small integer k.
So we need to find a number k that matches (e×d − 1) % k == 0.</p>
<p>We can use this python script that will try different numbers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e_public <span style="color:#f92672">=</span> <span style="color:#ae81ff">58271</span>
</span></span><span style="display:flex;"><span>d_public <span style="color:#f92672">=</span> <span style="color:#ae81ff">16314065939355844497428646964774413938010062495984944007868244761330321449198604198404787327825341236658059256072790190934480082681534717838850610633320375625893501985237981407305284860652632590435055933317638416556532857376955427517397962124909869006289022084571993305966362498048396739334756594170449299859</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">119082667712915497270407702277886743652985638444637188059938681008077058895935345765407160513555112013190751711213523389194925328565164667817570328474785391992857634832562389502866385475392702847788337877472422435555825872297998602400341624700149407637506713864175123267515579305109471947679940924817268027249</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">107089582154092285354514758987465112016144455480126366962910414293721965682740674205100222823439150990299989680593179350933020427732386716386685052221680274283469481350106415150660410528574034324184318354089504379956162660478769613136499331243363223860893663583161020156316072996007464894397755058410931262938</span>
</span></span><span style="display:flex;"><span>e_private <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x10001</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>phiNxK <span style="color:#f92672">=</span> e_public <span style="color:#f92672">*</span> d_public <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1000000</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(phiNxK <span style="color:#f92672">%</span> k) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        Dprivate <span style="color:#f92672">=</span> pow(e_private, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, phiNxK<span style="color:#f92672">//</span>k)
</span></span><span style="display:flex;"><span>        m <span style="color:#f92672">=</span> long_to_bytes(pow(c,Dprivate,N))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;mensaje: </span><span style="color:#e6db74">{</span>(m)<span style="color:#f92672">.</span>decode()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span></code></pre></div><p><strong>DawgCTF{kn0w1ng_d_1s_kn0w1ng_f4ct0rs}</strong></p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://pablo10diez2.github.io/webPablo/tags/rsa/">rsa</a></span>
        <span class="tag"><a href="https://pablo10diez2.github.io/webPablo/tags/cryptography/">Cryptography</a></span>
        <span class="tag"><a href="https://pablo10diez2.github.io/webPablo/tags/math/">math</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://pablo10diez2.github.io/webPablo/categories/cryptography/">Cryptography</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        352 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2025-04-19 02:00
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://pablo10diez2.github.io/webPablo/posts/dawgctf/64-bits/">
                    <span class="button__icon">←</span>
                    <span class="button__text">[PWN] 64 bits in my ark and texture</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://pablo10diez2.github.io/webPablo/posts/dawgctf/cantorspairadox/">
                    <span class="button__text">[Cryptography] Cantors Pairadox</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/webPablo/bundle.min.ac2a4bcaed631ec2dc154407be7f09fc28da37de71fae6dee6711b2a3d1622770f87d3cda22c460e9a68ff619bdb1dd75cb7a5d33f159a54e419736cc4541087.js" integrity="sha512-rCpLyu1jHsLcFUQHvn8J/CjaN95x&#43;ube5nEbKj0WIncPh9PNoixGDppo/2Gb2x3XXLel0z8VmlTkGXNsxFQQhw=="></script>




    </body>
</html>
